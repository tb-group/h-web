
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
 <link rel="icon" href="https://static.jianshukeji.com/highcharts/images/favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1">	<meta name="description" content="">
	<title>水质实时数据</title>
	<script src="https://img.hcharts.cn/highcharts/highcharts.js"></script>
	<script src="https://img.hcharts.cn/highcharts/highcharts-more.js"></script>
	<script src="https://img.hcharts.cn/highcharts/modules/solid-gauge.js"></script>
	<script src="https://img.hcharts.cn/highcharts-plugins/highcharts-zh_CN.js"></script>

    <script src="js/jquery.min.js?v=2.1.4"></script>

    <link rel="shortcut icon" href="favicon.ico">
    <link href="css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css?v=4.1.0" rel="stylesheet">
</head>
<body>
<!--
*************************************************************************
    Generated by JShare at 2018-11-26 11:02:19
    From: https://code.hcharts.cn/demos/hhhhiD
*************************************************************************
-->

<script> 
	function showtime(){ 
	var date = new Date(); //日期对象 
	var now = ""; 
	now = date.getFullYear()+"年"; //读英文就行了 
	now = now + (date.getMonth()+1)+"月"; //取月的时候取的是当前月-1如果想取当前月+1就可以了 
	now = now + date.getDate()+"日"; 
	now = now + date.getHours()+"时"; 
	now = now + date.getMinutes()+"分"; 
	now = now + date.getSeconds()+"秒"; 
	document.getElementById("time").innerHTML = now; //div的html是now这个字符串 
	setTimeout("showtime()",1000); //设置过1000毫秒就是1秒，调用show方法 
	} 
</script> 
		
<div style="width: 600px; height: 400px; margin: 0 auto">
    <h3 align="center">CODcr水质实时数据</h3>
    <div class="col-sm-12">
        <div class="row">
            <div class="col-sm-3">
                    <div class="sk-spinner sk-spinner-pulse"></div>
            </div>
            <div class="col-sm-6">
                <div id="time" align="center" class="btn btn-primary btn-rounded btn-block">
                    <script type="text/javascript">showtime();</script>
                </div>
            </div>
            <div class="col-sm-3">
                <a class="btn btn-primary btn-rounded btn-block" href="page_todcr_setting.html#">水质参数设置</a>
            </div>
        </div>
    </div>
	
    <div id="container-speed" style="width: 300px; height: 200px; float: left"></div>
    <div id="container-rpm" style="width: 300px; height: 200px; float: left"></div>
    <div id="container-speed3" style="width: 300px; height: 200px; float: left"></div>
    <div id="container-rpm4" style="width: 300px; height: 200px; float: left"></div>
</div>

<script>
	// 公共配置
	Highcharts.setOptions({
	    chart: {
	        type: 'solidgauge'
	    },
	    title: null,
	    pane: {
	        center: ['50%', '85%'],
	        size: '150%',
	        startAngle: -90,
	        endAngle: 90,
	        background: {
	            backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
	            innerRadius: '60%',
	            outerRadius: '100%',
	            shape: 'arc'
	        }
	    },
	    tooltip: {
	        enabled: false
	    },
	    yAxis: {
	        stops: [
	            [0.1, '#55BF3B'], // green
	            [0.5, '#DDDF0D'], // yellow
	            [0.9, '#DF5353'] // red
	        ],
	        lineWidth: 0,
	        minorTickInterval: null,
	        tickPixelInterval: 400,
	        tickWidth: 0,
	        title: {
	            y: -70
	        },
	        labels: {
	            y: 16
	        }
	    },
	    plotOptions: {
	        solidgauge: {
	            dataLabels: {
	                y: 5,
	                borderWidth: 0,
	                useHTML: true
	            }
	        }
	    }
	});
	// 速度仪表
	var chart1 = Highcharts.chart('container-speed', {
	    yAxis: {
	        min: 0,
	        max: 100,
	        title: {
	            text: 'CODcr'
	        }
	    },
	    credits: {
	        enabled: false
	    },
	    series: [{
	        name: '速度',
	        data: [40],
	        dataLabels: {
	            format: '<div style="text-align:center"><span style="font-size:25px;color:' +
	            ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y:.1f}</span><br/>' +
	            '<span style="font-size:12px;color:silver">unit</span></div>'
	        },
	        tooltip: {
	            valueSuffix: ' km/h'
	        }
	    }]
	});
	// 转速仪表
	var chart2 = Highcharts.chart('container-rpm', {
	    yAxis: {
	        min: 0,
	        max: 100,
	        title: {
	            text: 'TP'
	        }
	    },
	    series: [{
	        name: 'RPM',
	        data: [40],
	        dataLabels: {
	            format: '<div style="text-align:center"><span style="font-size:25px;color:' +
	            ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y:.1f}</span><br/>' +
	            '<span style="font-size:12px;color:silver">unit</span></div>'
	        },
	        tooltip: {
	            valueSuffix: ' revolutions/min'
	        }
	    }]
	});
	// 速度仪表1
	var chart3 = Highcharts.chart('container-speed3', {
	    yAxis: {
	        min: 0,
	        max: 100,
	        title: {
	            text: 'TN'
	        }
	    },
	    credits: {
	        enabled: false
	    },
	    series: [{
	        name: '速度',
	        data: [40],
	        dataLabels: {
	            format: '<div style="text-align:center"><span style="font-size:25px;color:' +
	            ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y:.1f}</span><br/>' +
	            '<span style="font-size:12px;color:silver">unit</span></div>'
	        },
	        tooltip: {
	            valueSuffix: ' km/h'
	        }
	    }]
	});
	// 转速仪表2
	var chart4 = Highcharts.chart('container-rpm4', {
	    yAxis: {
	        min: 0,
	        max: 100,
	        title: {
	            text: 'NH3N'
	        }
	    },
	    series: [{
	        name: 'RPM',
	        data: [40],
	        dataLabels: {
	            format: '<div style="text-align:center"><span style="font-size:25px;color:' +
	            ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y:.1f}</span><br/>' +
	            '<span style="font-size:12px;color:silver">unit</span></div>'
	        },
	        tooltip: {
	            valueSuffix: ' revolutions/min'
	        }
	    }]
	});

	// 定时刷新数据
    /*setInterval(function () {
        var point,
            newVal;
        $.ajax({
            url: './php-dah/php_t_codcrvalue.php',
            success: function(data) {

                if (chart1) {
                    point = chart1.series[0].points[0];
                    //取返回data的对应数值，并且把字符串转为数值
                    newVal = parseFloat(data[0].codcr);
                    //console.log(newVal);
                    point.update(newVal);
                }
                if (chart2) {
                    point = chart2.series[0].points[0];
                    //取返回data的对应数值，并且把字符串转为数值
                    newVal = parseFloat(data[0].tp);
                    //console.log(newVal);
                    point.update(newVal);
                }
                if (chart3) {
                    point = chart3.series[0].points[0];
                    //取返回data的对应数值，并且把字符串转为数值
                    newVal = parseFloat(data[0].tn);
                    //console.log(newVal);
                    point.update(newVal);
                }
                if (chart4) {
                    point = chart4.series[0].points[0];
                    //取返回data的对应数值，并且把字符串转为数值
                    newVal = parseFloat(data[0].nh3n);
                    //console.log(newVal);
                    point.update(newVal);
                }
            },
            cache: false
        });

    }, 2000);*/

    //json test start
    setInterval(function(){
        //alert("outside getjson");
        $.getJSON("./php-dah/php_t_codcrvalue.php",function(data){
            //alert (data.codcr);
            //alert("inside getjson");
            //console.log(data.codcr);
            if (chart1) {
                point = chart1.series[0].points[0];
                //取返回data的对应数值，并且把字符串转为数值
                newVal = parseFloat(data.codcr);
                //console.log(newVal);
                point.update(newVal);
            }
            if (chart2) {
                point = chart2.series[0].points[0];
                //取返回data的对应数值，并且把字符串转为数值
                newVal = parseFloat(data.tp);
                //console.log(newVal);
                point.update(newVal);
            }
            if (chart3) {
                point = chart3.series[0].points[0];
                //取返回data的对应数值，并且把字符串转为数值
                newVal = parseFloat(data.tn);
                //console.log(newVal);
                point.update(newVal);
            }
            if (chart4) {
                point = chart4.series[0].points[0];
                //取返回data的对应数值，并且把字符串转为数值
                newVal = parseFloat(data.nh3n);
                //console.log(newVal);
                point.update(newVal);
            }
        });
    },2000);
    //json test end

</script>
</body>
</html>